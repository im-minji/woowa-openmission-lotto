<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>당첨 회차 목록</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="site-header">
    <nav class="navbar">
        <div class="nav-links">
            <a href="my-lotto.html" class="nav-link">MyLotto</a>
            <a href="random-lotto.html" class="nav-link">RandomLotto</a>
            <a href="purchased-lotto.html" class="nav-link">PurchasedLotto</a>
            <a href="winning-lotto.html" class="nav-link" style="color: #003458; font-weight: bold;">WinningResult</a>
        </div>
        <a href="index.html" class="nav-link">
            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1V9a1 1 0 011-1h2a1 1 0 011 1v10a1 1 0 001 1m-6 0h6" />
            </svg>
        </a>
    </nav>
</header>

<main class="main-content">
    <h1 class="content-title">당첨 회차 목록</h1>
    <p class="content-subtitle">등록된 당첨 번호 목록입니다. '결과 확인'을 눌러 상세 통계를 확인하세요.</p>

    <div style="text-align: right; margin-bottom: 1rem;">
        <a href="winning-lotto-add.html" class="btn btn-primary">새 당첨 번호 등록</a>
    </div>

    <table class="lotto-table">
        <thead>
        <tr>
            <th>추첨일 (기준일)</th>
            <th>당첨 번호</th>
            <th>보너스</th>
            <th>상세보기</th>
        </tr>
        </thead>
        <tbody id="winning-list-body">
        <tr><td colspan="4">데이터를 불러오는 중...</td></tr>
        </tbody>
    </table>
</main>

<footer class="site-footer">
    <p>Copyright &copy; 2025 Im-minji</p>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const tableBody = document.getElementById('winning-list-body');

        try {
            // [API 호출] 목록 조회
            const response = await fetch('/im-minji/winning-lotto');
            if (!response.ok) throw new Error('목록을 불러오는데 실패했습니다.');

            const list = await response.json();
            tableBody.innerHTML = ''; // 로딩 문구 제거

            if (list.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="4">등록된 당첨 번호가 없습니다.</td></tr>';
                return;
            }

            // 리스트 렌더링
            list.forEach(item => {
                const tr = document.createElement('tr');
                // item: { id, drawDate, numbers: [], bonusNum }
                tr.innerHTML = `
                    <td>${item.drawDate}</td>
                    <td style="letter-spacing: 2px; font-weight: bold; color: #003458;">
                        ${item.numbers.join(', ')}
                    </td>
                    <td style="color: #d9534f; font-weight: bold;">${item.bonusNum}</td>
                    <td>
                        <a href="winning-lotto-result.html?date=${item.drawDate}" class="btn btn-small btn-secondary">결과 확인</a>
                    </td>
                `;
                tableBody.appendChild(tr);
            });
        } catch (error) {
            tableBody.innerHTML = `<tr><td colspan="4" class="error-text">${error.message}</td></tr>`;
        }
    });
</script>
</body>
</html>